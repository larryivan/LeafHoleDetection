## 方法

本研究开发了一套基于计算机视觉技术的自动化叶片孔洞检测系统，该系统集成了图像预处理、参照标定、智能分割和精确测量等多个技术模块，能够实现对植物叶片虫蛀损伤的定量化分析。

### 图像预处理与增强

为确保后续分析的准确性，系统首先对输入图像进行多层次的预处理。采用双边滤波器对原始图像进行降噪处理，该滤波器在平滑图像的同时能够有效保持边缘信息。随后，将图像转换至LAB颜色空间，并对L通道应用对比度限制自适应直方图均衡化(CLAHE)技术，以增强图像的局部对比度。通过自动白平衡算法校正色彩偏差，使背景呈现均匀的白色。最后应用锐化核进行边缘增强，提升叶片轮廓和孔洞边界的清晰度。

### 参照方块检测与尺度标定

系统实现了多策略的1cm×1cm参照方块自动检测算法。首先采用Otsu自动阈值法检测暗色参照物，利用形态学闭运算和开运算消除噪声影响；其次运用自适应阈值技术识别亮色参照物；最后结合Canny边缘检测算法捕获边界清晰的参照方块。对检测到的轮廓进行多边形近似，筛选四边形候选区域，并通过边长一致性、紧密度和长宽比等几何特征确定最佳参照方块。基于参照方块的像素边长建立像素-厘米转换关系，实现从相对测量到绝对测量的转换。

### 叶片智能分割

采用改进的Otsu阈值分割算法将叶片从白色背景中分离。通过形态学闭运算填补叶片内部的细小间隙，开运算去除噪声点。利用轮廓面积最大化原则确定主要叶片区域，生成精确的叶片掩膜。该方法能够有效处理复杂的叶片形态和不均匀的光照条件。

### 孔洞检测与识别

系统采用多模态融合的孔洞检测策略。首先通过中值滤波抑制细长叶脉对检测的干扰，然后基于亮度阈值(230)直接提取叶片内部的高亮区域作为潜在孔洞。同时，通过叶片边界形态学膨胀与原始掩膜的差值运算检测边缘凹陷型孔洞。为确保检测质量，引入形状过滤机制：计算每个候选区域的圆度((4πA)/P²，其中A为面积，P为周长)和长宽比，剔除过于细长的叶脉状结构，保留紧凑的孔洞区域。

### 叶片形态参数测定

利用最小外接椭圆拟合技术精确测定叶片的形态学参数。通过椭圆拟合获取叶片的主轴和次轴信息，主轴长度定义为叶片长度，次轴长度定义为叶片宽度。当椭圆拟合失败时，系统自动切换至轮廓点间最大距离法作为备选方案，确保测量的鲁棒性。

### 定量分析与质量控制

系统计算多项定量指标：虫蛀面积占比、孔洞数量、叶片总面积、受损面积以及叶片形态参数。当检测到参照方块时，所有像素测量值均转换为绝对物理量(cm²和cm)。该检测系统整合了传统图像处理技术与现代计算机视觉算法，具备高精度、高效率和强适应性的特点，为植物病虫害的定量评估提供了可靠的技术支撑。